<!DOCTYPE html>
@using System.Threading
@{
    var t = (Request.Cookies["gtx-theme"]?.Value ?? "blue").ToLowerInvariant();
    var current = Thread.CurrentThread.CurrentUICulture.TwoLetterISOLanguageName;
    // allow only known themes
    switch (t)
    {
        case "grey":
        case "pink":
        case "blue":
        case "deep-purple":
        case "dark":
        case "metallica":
            break;
        default:
            t = "blue";
            break;
    }

    var themeClass = "theme-" + t;
}
<html class="@themeClass">
<head class="flex-shrink-0">
    <meta charset="utf-8" />
    @RenderSection("Meta", required: false)

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>GTX Autogroup</title>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" />

    <script>
        (function () {
            window.gtxI18n = window.gtxI18n || {};
            window.gtxI18n = {
                searchWithinResults: '@Html.Raw(HttpUtility.JavaScriptStringEncode(I18n.R("All_SearchInResults")))',
                clickToSearchInventory: '@Html.Raw(HttpUtility.JavaScriptStringEncode(I18n.R("All_SearchInventory")))',
            };

            var KEY = "gtx-theme";
            const THEMES = ["blue", "grey", "pink", "deep-purple", "metallica"]; // add more here
            var t = localStorage.getItem(KEY) || "blue"; // default
            var root = document.documentElement;

            // remove any theme classes first
            root.classList.remove(...THEMES.map(t => "theme-" + t));

            // add selected theme
            root.classList.add("theme-" + t);
        })();
    </script>


    @Styles.Render("~/Content/css")
    @Scripts.Render("~/scripts/modernizr")
    @Scripts.Render("~/scripts/bootstrap")

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>

    <script src="~/Scripts/just-validate/just-validate.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js"></script>

    <script type="text/javascript">
        var root = "@Url.Content("~/")";
        var images = "@Url.Content("~/GTXImages/Inventory/")";
    </script>
    <script src="~/Scripts/inventory.js"></script>
</head>

@Html.Action("LoginModal", "Home")
<body class="main-container overflow-hidden d-flex flex-column min-vh-100">
    <!-- Offcanvas open hours -->
    <div class="offcanvas-top-fixed-center" tabindex="-1" id="openHours">
        <div class="offcanvas-body">
            @Html.Partial("_Schedule")
        </div>
    </div>
    <div class="offcanvas offcanvas-start" tabindex="-1" id="mobileMenuOffcanvas" aria-labelledby="mobileMenuLabel">
        <div class="offcanvas-header">
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body p-0">
            <!-- KEEP YOUR EXISTING WRAPPER EXACTLY AS IS -->
            <div class="offcanvas-menu-wrapper p-5 active w-100">
                <ul class="main-menu list-unstyled mb-0">
                    <!-- Top row: Logo + Phone (pill buttons) -->
                    <li class="d-flex align-items-center justify-content-between gap-2 mb-2">
                        <a href="~/Home/Index" class="d-flex align-items-center text-decoration-none">
                            <img src="~/GTXImages/GTX-Black.png" width="100" />
                        </a>

                        <a class="btn btn-gradient-grey rounded-3 d-flex align-items-center gap-2" href="tel:+15134892886">
                            <i class="bi bi-telephone"></i>
                            <span class="fw-semibold">(513) 489-2886</span>
                        </a>
                    </li>

                    <li><hr class="my-2"></li>

                    <!-- Inventory (collapsible header = bold black pill) -->
                    <li class="mb-2">
                        <a class="btn btn-gradient-grey rounded-3 w-100 d-flex align-items-center justify-content-between text-dark fw-bold shadow" data-bs-toggle="collapse" href="#menuInventoryMobile" role="button" aria-expanded="false" aria-controls="menuInventoryMobile">
                            <span><i class="bi bi-car-front me-2"></i>@I18n.R("Nav_Inventory")</span>
                            <i class="bi bi-chevron-down"></i>
                        </a>
                        <!-- Submenu (indented list-group look) -->
                        <ul id="menuInventoryMobile" class="collapse list-unstyled mt-2 ms-3 p-2" data-bs-parent="#mobileMenuOffcanvas">
                            <li class="mb-1 shadow-sm">@Html.ActionLink(I18n.R("Nav_All"), "All", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1 shadow-sm">@Html.ActionLink(I18n.R("Nav_SUVs"), "Suvs", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1 shadow-sm">@Html.ActionLink(I18n.R("Nav_Trucks"), "Trucks", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1 shadow-sm">@Html.ActionLink(I18n.R("Nav_Vans"), "Vans", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1 shadow-sm">@Html.ActionLink(I18n.R("Nav_Hatchbacks"), "Hatchbacks", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1 shadow-sm">@Html.ActionLink(I18n.R("Nav_Coupes"), "Coupes", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1 shadow-sm">@Html.ActionLink(I18n.R("Nav_Sedans"), "Sedans", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1 shadow-sm">@Html.ActionLink(I18n.R("Nav_Convertibles"), "Convertibles", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                        </ul>
                    </li>

                    <!-- About (collapsible) -->
                    <li class="mb-2">
                        <a class="btn btn-gradient-grey rounded-3 w-100 d-flex align-items-center justify-content-between text-dark fw-bold shadow" data-bs-toggle="collapse" href="#menuAboutMobile" role="button" aria-expanded="false" aria-controls="menuAboutMobile">
                            <span><i class="bi bi-info-circle me-2"></i>@I18n.R("Nav_AboutUs")</span>
                            <i class="bi bi-chevron-down"></i>
                        </a>

                        <ul id="menuAboutMobile" class="collapse list-unstyled mt-2 ms-3 p-2" data-bs-parent="#mobileMenuOffcanvas">
                            <li class="mb-1 shadow-sm">@Html.ActionLink(I18n.R("Nav_AboutUs"), "About", "Home", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1 shadow-sm"><a class="btn btn-outline-dark w-100 text-start rounded-3" data-bs-dismiss="offcanvas" href="@Url.RouteUrl("Default", new { controller = "Home", action = "Contact" })">@I18n.R("Nav_ContactUs")</a></li>
                            <li class="mb-1 shadow-sm">@Html.ActionLink(I18n.R("Nav_OurStaff"), "Staff", "Home", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1 shadow-sm">@Html.ActionLink(I18n.R("Nav_Testimonials"), "Testimonials", "Home", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                        </ul>
                    </li>

                    <!-- Hours / Schedule (collapsible + centered address) -->
                    <li class="mb-2">
                        <a class="btn btn-gradient-grey rounded-3 w-100 d-flex align-items-center justify-content-between text-dark fw-bold shadow" data-bs-toggle="collapse" href="#menuScheduleMobile" role="button" aria-expanded="false" aria-controls="menuScheduleMobile">
                            <span><i class="bi bi-stopwatch me-2"></i>Hours / Schedule</span>
                            <i class="bi bi-chevron-down"></i>
                        </a>

                        <div id="menuScheduleMobile" class="collapse mt-2" data-bs-parent="#mobileMenuOffcanvas">
                            <div class="text-center py-2">
                                <div class="fw-bold text-dark">9516 Princeton Glendale Rd</div>
                                <div class="text-secondary small">West Chester Township, OH 45011</div>
                            </div>

                            <div class="border rounded-3 p-2 bg-light">
                                @Html.Partial("_ScheduleMobile")
                            </div>
                        </div>
                    </li>

                    <!-- Search (primary style) -->
                    <li class="mb-2 shadow-sm">
                        <a class="btn btn-dark w-100 rounded-3 d-flex align-items-center justify-content-center gap-2 shadow" href="#" onclick="openFiltersFromOffcanvas(event)">
                            <i class="bi bi-search"></i>
                            <span class="fw-semibold">@I18n.R("All_SearchInventory")</span>
                        </a>
                    </li>

                    <!-- Prequalified (success-ish outline) -->
                    <li class="mb-2 shadow-sm">@Html.ActionLink("💲 " + I18n.R("Nav_GetPrequalified"), "Application", "Home", null, new { @class = "btn btn-outline-success w-100 rounded-3 fw-semibold" })</li>

                </ul>
            </div>

        </div>
    </div>
    <!-- Offcanvas Menu End -->

    @{
        Html.RenderPartial("_SearchForm");
        var _class = "d-none";
        if ((ViewBag.IsMajordome as bool?) == true)
        {
            _class = string.Empty;
        }
    }

    <!-- Header Section Begin -->
<header class="header fixed-top">
    <div class="canvas__open">
        <button class="btn btn-gradient-grey" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileMenuOffcanvas"><i class="bi bi-list"></i></button>
    </div>
    <div class="menu-strip container-fluid">
        <div class="d-flex justify-content-between">
            <nav class="header__top header__menu w-100">
                <ul class="main-menu">
                    <li id="GTX-image" class="d-none d-md-inline-block mx-1"><a href="~/Home/Index"><img src="~/GTXImages/GTX-White.png" width="60" /></a></li>
                    <li id="MajordomeLink" class="@_class mx-1">
                        <a href="#" class="btn gradient shadow border-dark rounded-4 d-inline-flex align-items-center text-black">
                            <i class="bi bi-gear px-2"></i>
                        </a>
                        <ul class="dropdown rounded">
                            <li id="menuInventory">@Html.ActionLink("Majordome", "Inventory", "Majordome")</li>
                            <li id="menuVinDecoder">@Html.ActionLink("Vindecoder", "Index", "Vindecoder")</li>
                            <li id="menuAnnouncements">@Html.ActionLink("Alerts", "Index", "Announcements")</li>
                            <li id="menuBlogs">@Html.ActionLink("Blogs", "Index", "Blogs")</li>
                            <li id="menuEmployees">@Html.ActionLink("Employees", "Index", "Employees")</li>
                            <li id="menuHealth">@Html.ActionLink("Health", "Index", "Health")</li>
                            <li id="menuSitemap">@Html.ActionLink("Sitemap", "Index", "Sitemap")</li>
                        </ul>
                    </li>
                    <li class=" mx-2">
                        <a href="#">@I18n.R("Nav_Inventory")</a>
                        <ul class="dropdown rounded">
                            <li>@Html.ActionLink(I18n.R("Nav_All"), "All", "Inventory")</li>
                            <li>@Html.ActionLink(I18n.R("Nav_SUVs"), "Suvs", "Inventory")</li>
                            <li>@Html.ActionLink(I18n.R("Nav_Trucks"), "Trucks", "Inventory")</li>
                            <li>@Html.ActionLink(I18n.R("Nav_Vans"), "Vans", "Inventory")</li>
                            <li>@Html.ActionLink(I18n.R("Nav_Hatchbacks"), "Hatchbacks", "Inventory")</li>
                            <li>@Html.ActionLink(I18n.R("Nav_Coupes"), "Coupes", "Inventory")</li>
                            <li>@Html.ActionLink(I18n.R("Nav_Sedans"), "Sedans", "Inventory")</li>
                            <li>@Html.ActionLink(I18n.R("Nav_Convertibles"), "Convertibles", "Inventory")</li>
                        </ul>
                    </li>

                    <li class="mx-2">@Html.ActionLink("💲" + I18n.R("Nav_GetPrequalified"), "Application", "Home")</li>
                    <li class="mx-2">@Html.ActionLink(I18n.R("Title_Blog"), "List", "Blogs")</li>
                    <li class="mx-2">
                        <a href="#">@I18n.R("Nav_AboutUs")</a>
                        <ul class="dropdown rounded">
                            <li>@Html.ActionLink(I18n.R("Nav_AboutUs"), "About", "Home")</li>
                            <li><a href="@Url.RouteUrl("Default", new { controller = "Home", action = "Contact" })">@I18n.R("Nav_ContactUs")</a></li>
                            <li>@Html.ActionLink(I18n.R("Nav_OurStaff"), "Staff", "Home")</li>
                            <li>@Html.ActionLink(I18n.R("Nav_Testimonials"), "Testimonials", "Home")</li>
                        </ul>
                    </li>
                    <li id="fakeSearch" class="fake-input hand-pointer d-none d-xl-inline-flex" data-bs-toggle="modal" data-bs-target="#filtersModal">
                        @Html.Partial("_SearchByTerm")
                    </li>
                    <li class="d-xxl-none">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#filtersModal">
                            <i class="bi bi-search"></i>
                        </a>
                    </li>
                </ul>
            </nav>
            <nav class="header__top d-none d-xxl-flex">
                <ul class="main-menu start-100 list-unstyled no-wrap-group">
                    <li class="mx-sm-1 nav-addr-hours hand-pointer" data-bs-toggle="offcanvas" data-bs-target="#openHours" aria-controls="openHours">
                        <div class="addr-line1">9516 Princeton Glendale Rd</div>
                        <div class="addr-line2">West Chester Township, OH 45011</div>
                    </li>
                    <li class="mx-sm-1">
                        <a class="btn btn-gradient-grey border-dark rounded-4" id="btnOpenHours" data-bs-toggle="offcanvas" data-bs-target="#openHours" aria-controls="openHours">
                            <i class="bi bi-stopwatch"></i>
                            <span id="schedule" class="schedule d-none d-xxl-inline m-sm-1"></span>
                        </a>
                    </li>
                    <li class="mx-sm-1">
                        <a class="btn btn-gradient-grey border-dark rounded-4" href="tel:(513) 489-2886">
                            <i class="bi bi-telephone"></i>
                            <span id="telephone" class="d-none d-xxl-inline m-sm-1">(513) 489-2886</span>
                        </a>
                    </li>
                    <li class="mx-sm-1">
                        <a class="btn gradient shadow border-dark rounded-4" href="https://www.facebook.com/GTXAutoGroup" target="_blank" title="GTX Facebook page">
                            <i class="fa fa-facebook px-2"></i>
                        </a>
                    </li>
                    <li class="mx-sm-1">
                        <a class="btn gradient shadow border-dark rounded-4" href="https://www.twitter.com/GTXAutoGroup" target="_blank" title="GTX Meta page">
                            <i class="fa fa-twitter px-1"></i>
                        </a>
                    </li>
                    <li class="mx-sm-1">
                        <a class="btn gradient shadow border-dark rounded-4" href="#" title="Log in" data-bs-toggle="modal" data-login-modal="true">
                            <i class="bi bi-person-circle px-1 role-icon"></i>
                            <span class="role-text text-shadow-small fw-bold"></span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    @{
        if (ViewBag.Message != "Home")
        {
            @Html.Partial("_CategoryFilter")
            @Html.Partial("_PageTitle")
        }
    }

</header>
    <!-- Header Section End -->

    <!-- MAIN WRAPPER -->
    <div class="very-top d-flex flex-column flex-grow-1">
        <!-- Loading...  overlay -->
        <div id="loadingOverlay" class="spinner-overlay spinner-hidden">
            <div class="spinner-border text-danger" role="status">
            </div>
        </div>

        <main class="body-content overflow-y-auto overflow-x-hidden flex-grow-1 min-h-0">
            <!-- Announcement -->
            <div class="toast-container position-fixed top-25 start-50 translate-middle-x p-3 pe-auto" style="z-index: 99999; top: 11rem;">
                <div id="announcementPreviewHostPopup" class="pe-auto"></div>
            </div>

            <div id="announcementPreviewHostBanner" class="position-fixed start-50 translate-middle-x pe-auto w-100" style="z-index: 99999; top: 12rem;">
            </div>

            @RenderBody()
        </main>
    </div>
    <!-- Footer Section Begin -->
    <footer class="footer-strip fixed-bottom btn-gradient-grey">
        <div class="container-fluid px-2">
            <div class="d-flex align-items-center justify-content-between gap-2 py-1 small-text flex-nowrap">

                <!-- LEFT: Status + time -->
                <div class="d-flex align-items-center flex-shrink-0">
                    <span id="inventoryStatus" class="status-circle" title="Very old"></span>
                    <span class="text-muted text-shadow ms-2 text-nowrap">
                        @ViewBag.Published.ToString("MM-dd HH:mm")
                    </span>
                </div>

                <!-- CENTER: Truncated content (prevents wrapping) -->
                <div class="flex-grow-1 text-center overflow-hidden">
                    <div class="d-inline-flex align-items-center gap-2 gap-lg-3 justify-content-center text-truncate"
                         style="max-width:100%;">

                        <!-- Brand/env (desktop only) -->
                        <a class="text-muted text-shadow text-decoration-none d-none d-lg-inline-flex align-items-center gap-2"
                           data-bs-toggle="offcanvas" href="#gtxDevelopment" role="button" aria-controls="gtxDevelopment">
                            <span>Copyright &copy; @DateTime.Now.Year ✧ Made by</span>
                            <span class="badge bg-primary">GTX</span>
                            <span class="text-nowrap">@ViewBag.Environment</span>
                            <span>✧</span>
                        </a>

                        <!-- Privacy (always visible) -->
                        <a href="@Url.Action("PrivacyPolicy", "Home")"
                           class="link-primary text-decoration-underline text-nowrap"
                           target="_blank" rel="noopener">
                            @I18n.R("Title_PrivacyPolicy")
                        </a>

                        <!-- Terms sentence (desktop only) -->
                        <span class="text-muted text-shadow d-none d-lg-inline text-nowrap">
                            ✧ By placing calls to this dealership you agree to the ✧
                            <a href="@Url.Action("TermsAndConditions", "Home")"
                               class="link-primary text-decoration-underline"
                               target="_blank" rel="noopener">
                                @I18n.R("Title_Terms")
                            </a>
                        </span>

                    </div>
                </div>

                <!-- RIGHT: Theme + Language (never wrap) -->
                <div class="d-flex align-items-center gap-2 flex-shrink-0 flex-nowrap">

                    <!-- Theme dropdown -->
                    <div class="dropdown">
                        <button class="btn btn-sm btn-gradient dropdown-toggle text-nowrap"
                                type="button" id="themeDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            Theme: <span id="themeLabel">Blue</span>
                        </button>

                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="themeDropdown">
                            <li><a class="dropdown-item theme-item d-flex align-items-center gap-2" href="#" data-theme="blue"><span class="theme-swatch swatch-blue"></span> Blue</a></li>
                            <li><a class="dropdown-item theme-item d-flex align-items-center gap-2" href="#" data-theme="grey"><span class="theme-swatch swatch-grey"></span> Grey</a></li>
                            <li><a class="dropdown-item theme-item d-flex align-items-center gap-2" href="#" data-theme="pink"><span class="theme-swatch swatch-pink"></span> Pink</a></li>
                            <li><a class="dropdown-item theme-item d-flex align-items-center gap-2" href="#" data-theme="deep-purple"><span class="theme-swatch swatch-deep-purple"></span> Deep Purple</a></li>
                            <li><a class="dropdown-item theme-item d-flex align-items-center gap-2" href="#" data-theme="metallica"><span class="theme-swatch swatch-metallica"></span> Metallica</a></li>
                            <li><a class="dropdown-item theme-item d-flex align-items-center gap-2" href="#" data-theme="dark"><span class="theme-swatch swatch-dark"></span> Dark</a></li>
                        </ul>
                    </div>

                    <!-- Language dropdown -->
                    <div class="dropdown">
                        @{
                            var lang = (current ?? "en").ToLowerInvariant();
                            string flagSrc;

                            switch (lang)
                            {
                                case "es":
                                    flagSrc = Url.Content("~/img/flags/es.svg");
                                    break;

                                case "ua":
                                    flagSrc = Url.Content("~/img/flags/ua.svg");
                                    break;

                                case "en":
                                default:
                                    flagSrc = Url.Content("~/img/flags/us.svg");
                                    break;
                            }
                        }
                        <button class="btn btn-sm btn-gradient dropdown-toggle d-flex align-items-center gap-2 text-nowrap"
                                type="button" id="langDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            <img src="@flagSrc" width="16" height="16" class="rounded-1" alt="" />
                            <span class="text-uppercase">@current</span>
                        </button>

                        <div class="dropdown-menu dropdown-menu-end p-1 shadow" aria-labelledby="langDropdown" style="min-width: 11rem;">
                            <button type="button"
                                    class="dropdown-item d-flex align-items-center justify-content-between rounded-3 @(current=="en" ? "active" : "")"
                                    onclick="setLang('en')">
                                <span class="d-flex align-items-center gap-2">
                                    <img src="~/img/flags/us.svg" width="22" height="22" class="rounded-1 shadow-sm" alt="English" />
                                    English
                                </span>
                                @if (current == "en")
                                {<i class="bi bi-check2 text-success"></i>}
                            </button>

                            <button type="button"
                                    class="dropdown-item d-flex align-items-center justify-content-between rounded-3 @(current=="es" ? "active" : "")"
                                    onclick="setLang('es')">
                                <span class="d-flex align-items-center gap-2">
                                    <img src="~/img/flags/es.svg" width="22" height="22" class="rounded-1 shadow-sm" alt="Español" />
                                    Español
                                </span>
                                @if (current == "es")
                                {<i class="bi bi-check2 text-success"></i>}
                            </button>
                            <button type="button"
                                    class="dropdown-item d-flex align-items-center justify-content-between rounded-3 @(current=="ua" ? "active" : "")"
                                    onclick="setLang('ua')">
                                <span class="d-flex align-items-center gap-2">
                                    <img src="~/img/flags/ua.svg" width="22" height="22" class="rounded-1 shadow-sm" alt="Украинська" />
                                    Українська
                                </span>
                                @if (current == "ua")
                                {<i class="bi bi-check2 text-success"></i>}
                            </button>
                        </div>
                    </div>

                    <!-- Hidden form used by setLang() -->
                    <form id="langForm" method="post" action="@Url.Action("SetLanguage", "Localization")" class="d-none">
                        <input type="hidden" name="lang" id="langValue" value="@current" />
                    </form>

                </div>
            </div>
        </div>
    </footer>
    <!-- Footer Section End -->


    @Scripts.Render("~/scripts/jquery")
    @RenderSection("scripts", required: false)

    <div class="offcanvas offcanvas-bottom small-offcanvas centered rounded-5 text-white" tabindex="-1" id="gtxDevelopment" aria-labelledby="offcanvasBottomLabel">
        <div class="offcanvas-header btn-big-gradient-yellow rounded-top-5 rounded-bottom-0" style="transform: none !important;">
            <h5 class="offcanvas-title">GTX development</h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body text-black-50">
            <div class="offcanvas-body text-center">
                <p class="fs-5 fw-semibold text-muted">For any questions<i class="bi bi-question-circle mx-1"></i>please <i class="bi bi-phone-vibrate mx-1"></i> call</p>

                <p class="fs-4 fw-bold text-muted">
                    Valentin Gikhman
                </p>

                <a href="tel:+15136737887" class="text-decoration-none fs-5 text-primary">
                    (513) 673-7887
                </a>
            </div>
        </div>
    </div>

    <script>
        (() => {
            const KEY = "gtx-theme";
            const root = document.documentElement;
            const label = document.getElementById("themeLabel");

            const items = Array.from(document.querySelectorAll(".theme-item"));
            const themes = items.map(x => x.dataset.theme).filter(Boolean);
            const pretty = (t) => t ? (t.charAt(0).toUpperCase() + t.slice(1)) : "";

            function setCookie(name, value) {
                // 1 year, site-wide
                document.cookie = `${name}=${encodeURIComponent(value)}; path=/; max-age=31536000; samesite=lax`;
            }

            function applyTheme(theme) {
                themes.forEach(t => root.classList.remove("theme-" + t));
                root.classList.add("theme-" + theme);

                localStorage.setItem(KEY, theme);
                setCookie(KEY, theme);

                if (label) label.textContent = pretty(theme);
            }

            const saved = localStorage.getItem(KEY) || "blue";
            if (themes.includes(saved)) applyTheme(saved);

            items.forEach(a => {
                a.addEventListener("click", (e) => {
                    e.preventDefault();
                    applyTheme(a.dataset.theme);
                });
            });
            // ----------------------------
            // LANGUAGE (POST + reload)
            // ----------------------------
            const langForm = document.getElementById("langForm");
            const langInput = document.getElementById("langValue");

            window.setLang = function (lang) {
                try {
                    if (!langForm || !langInput) {
                        const url = new URL(window.location.href);
                        url.searchParams.set("lang", lang);
                        window.location.href = url.toString();
                        return;
                    }

                    langInput.value = lang;

                    fetch(langForm.action, {
                        method: "POST",
                        body: new FormData(langForm),
                        credentials: "same-origin"
                    })
                        .then(() => window.location.reload())
                        .catch(() => {
                            const url = new URL(window.location.href);
                            url.searchParams.set("lang", lang);
                            window.location.href = url.toString();
                        });
                } catch (e) {
                    const url = new URL(window.location.href);
                    url.searchParams.set("lang", lang);
                    window.location.href = url.toString();
                }
            };

        })();
    </script>
</body>
</html>

<script>
    window.gtx = window.gtx || {};
    window.gtx.currentRole = '@(ViewBag.CurrentRole ?? "")';
    setMajordomeMenu(window.gtx.currentRole);

    var cookieLike = 'likedCars';
    var likedCars = [];
    loadLikedCars();

    var cookieLast = 'lastCars';
    var lastCars = [];
    loadLastCars();

    let days = ((new Date("@DateTime.Now.ToString("yyyy-MM-ddTHH:mm")") - new Date("@ViewBag.Published.ToString("yyyy-MM-ddTHH:mm")")) / 86400000).toFixed(0);
    const status = `status-${days}`;
    $("#inventoryStatus").attr('title', `The inventory is ${days} days old`).removeClass().addClass(`status-circle ${status}`);

    function openFiltersFromOffcanvas(e) {
        e.preventDefault();

        const offEl = document.getElementById('mobileMenuOffcanvas');
        const modalEl = document.getElementById('filtersModal');

        if (!offEl || !offEl.classList.contains('offcanvas')) {
            bootstrap.Modal.getOrCreateInstance(modalEl).show();
            return;
        }

        const off = bootstrap.Offcanvas.getOrCreateInstance(offEl);
        off.hide();

        offEl.addEventListener('hidden.bs.offcanvas', function once() {
            offEl.removeEventListener('hidden.bs.offcanvas', once);
            bootstrap.Modal.getOrCreateInstance(modalEl).show();
        });
    }
</script>

