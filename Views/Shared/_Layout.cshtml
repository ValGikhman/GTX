<!DOCTYPE html>
<html>
<head class="flex-shrink-0">
    <meta charset="UTF-8">
    @RenderSection("Meta", required: false)

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>GTX Autogroup</title>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" />


    @Styles.Render("~/Content/css")
    @Scripts.Render("~/scripts/modernizr")
    @Scripts.Render("~/scripts/bootstrap")

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>

    <script src="~/Scripts/just-validate/just-validate.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js"></script>

    <script type="text/javascript">
        var root = "@Url.Content("~/")";
        var images = "@Url.Content("~/GTXImages/Inventory/")";
    </script>
    <script src="~/Scripts/inventory.js"></script>
</head>

<body class="overflow-hidden d-flex flex-column min-vh-100">
    <div class="offcanvas offcanvas-start" tabindex="-1" id="mobileMenuOffcanvas" aria-labelledby="mobileMenuLabel">
        <div class="offcanvas-header">
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body p-0">
            <!-- KEEP YOUR EXISTING WRAPPER EXACTLY AS IS -->
            <div class="offcanvas-menu-wrapper p-5 active w-100">
                <ul class="main-menu list-unstyled mb-0">
                    <!-- Top row: Logo + Phone (pill buttons) -->
                    <li class="d-flex align-items-center justify-content-between gap-2 mb-2">
                        <a href="~/Home/Index" class="d-flex align-items-center text-decoration-none">
                            <img src="~/GTXImages/GTX-Black.png" width="100" />
                        </a>

                        <a class="btn btn-gradient-grey rounded-3 d-flex align-items-center gap-2" href="tel:+15134892886">
                            <i class="bi bi-telephone"></i>
                            <span class="fw-semibold">(513) 489-2886</span>
                        </a>
                    </li>

                    <li><hr class="my-2"></li>

                    <!-- Inventory (collapsible header = bold black pill) -->
                    <li class="mb-2">
                        <a class="btn btn-gradient-grey rounded-3 w-100 d-flex align-items-center justify-content-between text-dark fw-bold shadow" data-bs-toggle="collapse" href="#menuInventory" role="button" aria-expanded="false" aria-controls="menuInventory">
                            <span><i class="bi bi-car-front me-2"></i>Inventory</span>
                            <i class="bi bi-chevron-down"></i>
                        </a>

                        <!-- Submenu (indented list-group look) -->
                        <ul id="menuInventory" class="collapse list-unstyled mt-2 ms-3 p-2" data-bs-parent="#mobileMenuOffcanvas">
                            <li class="mb-1">@Html.ActionLink("All", "All", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1">@Html.ActionLink("Suvs", "Suvs", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1">@Html.ActionLink("Trucks", "Trucks", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1">@Html.ActionLink("Vans", "Vans", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1">@Html.ActionLink("Hatchbacks", "Hatchbacks", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1">@Html.ActionLink("Coupes", "Coupes", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1">@Html.ActionLink("Sedans", "Sedans", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1">@Html.ActionLink("Convertibles", "Convertibles", "Inventory", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                        </ul>
                    </li>

                    <!-- About (collapsible) -->
                    <li class="mb-2">
                        <a class="btn btn-gradient-grey rounded-3 w-100 d-flex align-items-center justify-content-between text-dark fw-bold shadow" data-bs-toggle="collapse" href="#menuAbout" role="button" aria-expanded="false" aria-controls="menuAbout">
                            <span><i class="bi bi-info-circle me-2"></i>About us</span>
                            <i class="bi bi-chevron-down"></i>
                        </a>

                        <ul id="menuAbout" class="collapse list-unstyled mt-2 ms-3 p-2" data-bs-parent="#mobileMenuOffcanvas">
                            <li class="mb-1">@Html.ActionLink("About us", "About", "Home", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1">
                                <a class="btn btn-outline-dark w-100 text-start rounded-3" data-bs-dismiss="offcanvas" href="@Url.RouteUrl("Default", new { controller = "Home", action = "Contact" })">Contact us</a>
                            </li>
                            <li class="mb-1">@Html.ActionLink("Our staff", "Staff", "Home", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                            <li class="mb-1">@Html.ActionLink("Testimonials", "Testimonials", "Home", null, new { @class = "btn btn-outline-dark w-100 text-start rounded-3" })</li>
                        </ul>
                    </li>

                    <!-- Hours / Schedule (collapsible + centered address) -->
                    <li class="mb-2">
                        <a class="btn btn-gradient-grey rounded-3 w-100 d-flex align-items-center justify-content-between text-dark fw-bold shadow" data-bs-toggle="collapse" href="#menuSchedule" role="button" aria-expanded="false" aria-controls="menuSchedule">
                            <span><i class="bi bi-stopwatch me-2"></i>Hours / Schedule</span>
                            <i class="bi bi-chevron-down"></i>
                        </a>

                        <div id="menuSchedule" class="collapse mt-2" data-bs-parent="#mobileMenuOffcanvas">
                            <div class="text-center py-2">
                                <div class="fw-bold text-dark">9516 Princeton Glendale Rd</div>
                                <div class="text-secondary small">West Chester Township, OH 45011</div>
                            </div>

                            <div class="border rounded-3 p-2 bg-light">
                                @Html.Partial("_ScheduleMobile")
                            </div>
                        </div>
                    </li>

                    <!-- Search (primary style) -->
                    <li class="mb-2">
                        <a class="btn btn-dark w-100 rounded-3 d-flex align-items-center justify-content-center gap-2 shadow"
                           href="#" onclick="openFiltersFromOffcanvas(event)">
                            <i class="bi bi-search"></i>
                            <span class="fw-semibold">Search inventory</span>
                        </a>
                    </li>

                    <!-- Prequalified (success-ish outline) -->
                    <li class="mb-2">@Html.ActionLink("💲 Get prequalified", "Application", "Home", null, new { @class = "btn btn-outline-success w-100 rounded-3 fw-semibold shadow" })</li>

                </ul>
            </div>

        </div>
    </div>
    <!-- Offcanvas Menu End -->
    @{Html.RenderPartial("_SearchForm");}

    <!-- Header Section Begin -->
    <header class="header fixed-top">
        <div class="canvas__open">
            <button class="btn btn-gradient-grey" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileMenuOffcanvas"><i class="bi bi-list"></i></button>
        </div>
        <div class="menu-strip container-fluid">
            <div class="d-flex justify-content-between">
                <nav class="header__top header__menu w-100">
                    <ul class="main-menu">
                        <li id="GTX-image" class="d-none d-md-inline-block"><a href="~/Home/Index"><img src="~/GTXImages/GTX-White.png" width="60" /></a></li>
                        <li>
                            <a href="#">Inventory</a>
                            <ul class="dropdown rounded">
                                <li>@Html.ActionLink("All", "All", "Inventory")</li>
                                <li>@Html.ActionLink("Suvs", "Suvs", "Inventory")</li>
                                <li>@Html.ActionLink("Trucks", "Trucks", "Inventory")</li>
                                <li>@Html.ActionLink("Vans", "Vans", "Inventory")</li>
                                <li>@Html.ActionLink("Hatchbacks", "Hatchbacks", "Inventory")</li>
                                <li>@Html.ActionLink("Coupes", "Coupes", "Inventory")</li>
                                <li>@Html.ActionLink("Sedans", "Sedans", "Inventory")</li>
                                <li>@Html.ActionLink("Convertibles", "Convertibles", "Inventory")</li>
                            </ul>
                        </li>
                        @{
                            var _class = "d-none";
                            if ((ViewBag.IsMajordome as bool?) == true)
                            {
                                _class = string.Empty;
                            }
                            <li id="MajordomeLink" class=@_class>@Html.ActionLink("Majordome", "Inventory", "Majordome")</li>
                        }
                        <li>@Html.ActionLink("💲Get prequalified", "Application", "Home")</li>
                        <li>@Html.ActionLink("Blog", "Blogs", "BlogPosts")</li>
                        <li>
                            <a href="#">About us</a>
                            <ul class="dropdown rounded">
                                <li>@Html.ActionLink("About us", "About", "Home")</li>
                                <li><a href="@Url.RouteUrl("Default", new { controller = "Home", action = "Contact" })">Contact us</a></li>
                                <li>@Html.ActionLink("Our staff", "Staff", "Home")</li>
                                <li>@Html.ActionLink("Testimonials", "Testimonials", "Home")</li>
                            </ul>
                        </li>
                        <li id="fakeSearch" class="fake-input hand-pointer d-none d-xxl-inline-block w-25" data-bs-toggle="modal" data-bs-target="#filtersModal">
                            @Html.Partial("_SearchByTerm")
                        </li>
                        <li class="d-xxl-none">
                            <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#filtersModal">
                                <i class="bi bi-search"></i>
                            </a>
                        </li>
                    </ul>
                </nav>
                <nav class="header__top d-none d-xxl-flex">
                    <ul class="main-menu start-100 list-unstyled no-wrap-group">
                        <li class="mx-sm-1 nav-addr-hours hand-pointer" data-bs-toggle="offcanvas" data-bs-target="#openHours" aria-controls="openHours">
                            <div class="addr-line1">9516 Princeton Glendale Rd</div>
                            <div class="addr-line2">West Chester Township, OH 45011</div>
                        </li>
                        <li class="mx-sm-1">
                            <a class="btn btn-gradient-grey border-dark rounded-4" id="btnOpenHours" data-bs-toggle="offcanvas" data-bs-target="#openHours" aria-controls="openHours">
                                <i class="bi bi-stopwatch"></i>
                                <span id="schedule" class="schedule d-none d-xxl-inline m-sm-1"></span>
                            </a>
                        </li>
                        <li class="mx-sm-1">
                            <a class="btn btn-gradient-grey border-dark rounded-4" href="tel:(513) 489-2886">
                                <i class="bi bi-telephone"></i>
                                <span id="telephone" class="d-none d-xxl-inline m-sm-1">(513) 489-2886</span>
                            </a>
                        </li>
                        <li class="mx-sm-1">
                            <a class="btn gradient shadow border-dark rounded-4" href="https://www.facebook.com/GTXAutoGroup" target="_blank" title="GTX Facebook page">
                                <i class="fa fa-facebook px-2"></i>
                            </a>
                        </li>
                        <li class="mx-sm-1">
                            <a class="btn gradient shadow border-dark rounded-4" href="https://www.twitter.com/GTXAutoGroup" target="_blank" title="GTX Meta page">
                                <i class="fa fa-twitter px-1"></i>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
        @{
            if (ViewBag.Title != null && !ViewBag.Title.Contains("Home") && !ViewBag.Title.Contains("Inventory management"))
            {
                @Html.Partial("_CategoryFilter")
                @Html.Partial("_PageTitle")
            }
        }
    </header>
    <!-- Header Section End -->
    <!-- MAIN WRAPPER -->
    <div class="very-top d-flex flex-column flex-grow-1">
        <!-- Loading...  overlay -->
        <div id="loadingOverlay" class="spinner-overlay spinner-hidden">
            <div class="spinner-border text-danger" role="status">
            </div>
        </div>
        <main class="body-content overflow-y-auto overflow-x-hidden flex-grow-1 min-h-0">
            @RenderBody()
        </main>
    </div>
    <!-- Footer Section Begin -->
    <footer class="footer-strip fixed-bottom btn-gradient-grey">
        <div class="row p-1 align-items-center">
            <!-- LEFT: Status Circle -->
            <div class="col-auto d-flex align-items-center">
                <span id="inventoryStatus" class="status-circle" title="Very old"></span>
                <span class="text-muted text-shadow very-small-text mx-2">@ViewBag.Published.ToString("MM-dd HH:mm")</span>
            </div>

            <!-- CENTER: Copyright + Terms line -->
            <div class="col text-center">
                <a class="text-muted text-shadow" data-bs-toggle="offcanvas" href="#gtxDevelopment" role="button" aria-controls="gtxDevelopment">
                    <i class="fa fa-clock-o"></i>
                    <span class="d-none d-lg-inline">Copyright &copy; @DateTime.Now.Year | Made by</span>
                    <span class="badge bg-primary">GTX</span>
                    <span>&nbsp;@ViewBag.Environment</span>
                </a>

                <span class="text-muted text-shadow d-none d-lg-inline">
                    | By placing calls to this dealership you agree to the
                </span>
                <a href="@Url.Action("TermsAndConditions", "Home")" class="link-primary text-decoration-underline" target="_blank" rel="noopener">
                    Terms and Conditions of Use
                </a>
            </div>

        </div>
    </footer>

        <!-- Footer Section End -->

        @Scripts.Render("~/scripts/jquery")
        @RenderSection("scripts", required: false)

        <div class="offcanvas offcanvas-bottom small-offcanvas centered rounded-5 text-white" tabindex="-1" id="gtxDevelopment" aria-labelledby="offcanvasBottomLabel">
            <div class="offcanvas-header btn-big-gradient-yellow rounded-top-5 rounded-bottom-0" style="transform: none !important;">
                <h5 class="offcanvas-title">GTX development</h5>
                <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body text-black-50">
                <div class="offcanvas-body text-center">
                    <p class="fs-5 fw-semibold text-muted">
                        For any questions<i class="bi bi-question-circle mx-1"></i>
                        please <i class="bi bi-phone-vibrate mx-1"></i> call
                    </p>

                    <p class="fs-4 fw-bold text-muted">
                        Valentin Gikhman
                    </p>

                    <a href="tel:+15136737887" class="text-decoration-none fs-5 text-primary">
                        (513) 673-7887
                    </a>
                </div>
            </div>
        </div>
</body>
</html>

<script>
    var cookieLike = 'likedCars';
    var likedCars = [];
    loadLikedCars();

    var cookieLast = 'lastCars';
    var lastCars = [];
    loadLastCars();

    let days = ((new Date("@DateTime.Now.ToString("yyyy-MM-ddTHH:mm")") - new Date("@ViewBag.Published.ToString("yyyy-MM-ddTHH:mm")")) / 86400000).toFixed(0);
    const status = `status-${days}`;
    $("#inventoryStatus").attr('title', `The inventory is ${days} days old`).removeClass().addClass(`status-circle ${status}`);

    function openFiltersFromOffcanvas(e) {
        e.preventDefault();

        const offEl = document.getElementById('mobileMenuOffcanvas'); // must exist + be .offcanvas
        const modalEl = document.getElementById('filtersModal');

        if (!offEl || !offEl.classList.contains('offcanvas')) {
            // Offcanvas not found / wrong element -> just open the modal
            bootstrap.Modal.getOrCreateInstance(modalEl).show();
            return;
        }

        const off = bootstrap.Offcanvas.getOrCreateInstance(offEl);
        off.hide();

        offEl.addEventListener('hidden.bs.offcanvas', function once() {
            offEl.removeEventListener('hidden.bs.offcanvas', once);
            bootstrap.Modal.getOrCreateInstance(modalEl).show();
        });
    }

</script>

